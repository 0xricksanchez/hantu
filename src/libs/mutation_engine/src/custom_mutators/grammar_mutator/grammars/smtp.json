{
  "<start>": [["<smtp_session>"]],
  "<smtp_session>": [
    ["<smtp_command><CRLF><smtp_session>"],
    ["<smtp_reply><CRLF><smtp_session>"],
    [""]
  ],
  "<smtp_command>": [
    ["HELO <domain>"],
    ["EHLO <domain>"],
    ["MAIL FROM:<mailbox>"],
    ["RCPT TO:<mailbox>"],
    ["DATA"],
    ["RSET"],
    ["NOOP"],
    ["QUIT"],
    ["AUTH LOGIN <base64_credentials>"],
    ["AUTH PLAIN <base64_credentials>"],
    ["<custom_command>"]
  ],
  "<custom_command>": [["<letters_digits><command_params>"]],
  "<command_params>": [["<whitespace><text_char><command_params>"], [""]],
  "<mailbox>": [["<local_part>@<domain>"]],
  "<local_part>": [["<letters_digits>"], ["<letters_digits><local_part>"]],
  "<domain>": [["<subdomain>"], ["<subdomain>.<domain>"]],
  "<subdomain>": [["<letters_digits>"], ["<letters_digits><subdomain>"]],
  "<smtp_reply>": [["<reply_code><whitespace><reply_text>"]],
  "<reply_code>": [
    ["200"],
    ["201"],
    ["202"],
    ["211"],
    ["214"],
    ["220"],
    ["221"],
    ["250"],
    ["251"],
    ["252"],
    ["253"],
    ["354"],
    ["421"],
    ["450"],
    ["451"],
    ["452"],
    ["455"],
    ["500"],
    ["501"],
    ["502"],
    ["503"],
    ["504"],
    ["550"],
    ["551"],
    ["552"],
    ["553"],
    ["554"],
    ["555"]
  ],
  "<reply_text>": [["<text_line>"]],
  "<text_line>": [["<text_char>"], ["<text_char><text_line>"]],
  "<text_char>": [["<letters_digits>"], ["<special>"], ["<whitespace>"]],
  "<letters_digits>": [
    ["a"],
    ["b"],
    ["c"],
    ["d"],
    ["e"],
    ["f"],
    ["g"],
    ["h"],
    ["i"],
    ["j"],
    ["k"],
    ["l"],
    ["m"],
    ["n"],
    ["o"],
    ["p"],
    ["q"],
    ["r"],
    ["s"],
    ["t"],
    ["u"],
    ["v"],
    ["w"],
    ["x"],
    ["y"],
    ["z"],
    ["A"],
    ["B"],
    ["C"],
    ["D"],
    ["E"],
    ["F"],
    ["G"],
    ["H"],
    ["I"],
    ["J"],
    ["K"],
    ["L"],
    ["M"],
    ["N"],
    ["O"],
    ["P"],
    ["Q"],
    ["R"],
    ["S"],
    ["T"],
    ["U"],
    ["V"],
    ["W"],
    ["X"],
    ["Y"],
    ["Z"],
    ["0"],
    ["1"],
    ["2"],
    ["3"],
    ["4"],
    ["5"],
    ["6"],
    ["7"],
    ["8"],
    ["9"]
  ],
  "<special>": [
    ["!"],
    ["#"],
    ["$"],
    ["%"],
    ["&"],
    ["'"],
    ["*"],
    ["+"],
    ["-"],
    ["/"],
    ["="],
    ["?"],
    ["^"],
    ["_"],
    ["`"],
    ["{"],
    ["|"],
    ["}"],
    ["~"],
    ["("],
    [")"],
    ["<"],
    [">"],
    ["["],
    ["]"],
    [";"],
    [":"],
    ["@"],
    [","],
    ["."],
    ["\\"]
  ],
  "<whitespace>": [[" "], ["\\t"], ["\\n"], ["\\r"]],
  "<base64_credentials>": [
    ["<base64_char>"],
    ["<base64_char><base64_credentials>"]
  ],
  "<base64_char>": [
    ["A"],
    ["B"],
    ["C"],
    ["D"],
    ["E"],
    ["F"],
    ["G"],
    ["H"],
    ["I"],
    ["J"],
    ["K"],
    ["L"],
    ["M"],
    ["N"],
    ["O"],
    ["P"],
    ["Q"],
    ["R"],
    ["S"],
    ["T"],
    ["U"],
    ["V"],
    ["W"],
    ["X"],
    ["Y"],
    ["Z"],
    ["a"],
    ["b"],
    ["c"],
    ["d"],
    ["e"],
    ["f"],
    ["g"],
    ["h"],
    ["i"],
    ["j"],
    ["k"],
    ["l"],
    ["m"],
    ["n"],
    ["o"],
    ["p"],
    ["q"],
    ["r"],
    ["s"],
    ["t"],
    ["u"],
    ["v"],
    ["w"],
    ["x"],
    ["y"],
    ["z"],
    ["0"],
    ["1"],
    ["2"],
    ["3"],
    ["4"],
    ["5"],
    ["6"],
    ["7"],
    ["8"],
    ["9"],
    ["+"],
    ["/"],
    ["="]
  ],
  "<CRLF>": [["\r\n"]]
}
